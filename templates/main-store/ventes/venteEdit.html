{%extends 'main-store/base/baseStore.html' %}
{%block title%}Modifer vente{%endblock%}
{%load crispy_forms_tags%}
{%block content%}

<div class="row ">
    <div class="col-md-1"></div>
    <div class="col-md-11">
        <div>
            <div class="d-flex align-items-center" style="padding-top: 50px;">

                <i class="fa-regular fa-pen-to-square me-1"></i>
                <h5 class="mb-0">Modifier la vente</h5>

            </div>
            <hr>
        </div>
    </div>
</div>
<div class="row" style="padding-top: 20px;">
    <div class="col-md-1"></div>
    <div class="col-md-4">{% for message in messages%}
        {%if message%}
        <div class="alert alert-{{message.tags}}">
            {{message}}
        </div>
        {%endif%}
        {%endfor%}
    </div>
    <div class="col-md-5"></div>
</div>
<div class="row" style="padding-top: 30px;">

    <div class="col-md-1"></div>
    <div class="col-md-4">
        <form method="POST">
            {%csrf_token%}
            {{form|crispy}}
            <a class="btn btn-secondary " id="grey-btn" href="{%url 'venteList' %}">
                Annuler </a></td>
            <input class="btn btn-success btn-block" id="green-btn" type="submit" value="valider">
        </form>
    </div>
    <div class="col-md-7"></div>

    {%endblock%}
    {%block scripts%}
    <script>
        $('#id_type_Paiement_v').change(function () {
            function calculateMontant() {
                var qte_v = parseFloat($('#id_qte_v').val());
                var prix_unitaireVT = parseFloat($('#id_prix_unitaireVT').val());

                if (!isNaN(qte_v) && !isNaN(prix_unitaireVT)) {
                    $('#id_montant_v').val(qte_v * prix_unitaireVT);
                }
            }
            $('#id_prix_unitaireVT').on('input', calculateMontant);
            $('#id_qte_v').on('input', calculateMontant);

            var selectedValue = $(this).val();
            if (selectedValue === 'Partiel') {
                $('#id_montant_v').prop('readonly', false);

            } else {
                calculateMontant();

                $('#id_montant_v ').prop('readonly', true);
            }
        });
    </script>
    {%endblock%}